import{r as f,u as N,j as e,H as v,L as m}from"./app-Da5hok_Z.js";import{A as y}from"./AuthenticatedLayout-W5MPSpi7.js";import"./transition-B5hQLC2f.js";function M({caja:s,totalIngresos:h,totalEgresos:p,montoEsperado:i}){const[g,d]=f.useState(!1),{data:l,setData:x,post:u,processing:n,errors:o}=N({monto_cierre:"",observaciones:""}),b=r=>{r.preventDefault(),u(route("cajas.close",s.id),{onSuccess:()=>d(!1)})},t=r=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format(r||0),j=r=>new Date(r).toLocaleDateString("es-CO"),c=r=>new Date(r).toLocaleString("es-CO"),a=l.monto_cierre?parseFloat(l.monto_cierre)-parseFloat(i):0;return e.jsxs(y,{header:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Detalles de Caja"}),e.jsxs("div",{className:"flex items-center gap-3",children:[s.estado==="abierta"&&e.jsxs("button",{onClick:()=>d(!0),className:"inline-flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition font-semibold shadow-md",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),"Cerrar Caja"]}),e.jsx(m,{href:route("cajas.index"),className:"inline-flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition font-semibold",children:"Volver"})]})]}),children:[e.jsx(v,{title:"Detalles de Caja"}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"bg-white shadow-sm rounded-lg p-6 mb-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{children:[e.jsxs("h3",{className:"text-2xl font-bold text-gray-900",children:["Caja del ",j(s.fecha)]}),e.jsx("span",{className:`inline-flex items-center mt-2 px-3 py-1 rounded-full text-sm font-semibold ${s.estado==="abierta"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:s.estado==="abierta"?"Abierta":"Cerrada"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"border-l-4 border-blue-500 pl-4",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Usuario Apertura"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:s.usuario_apertura.name}),e.jsx("p",{className:"text-sm text-gray-500",children:c(s.hora_apertura)})]}),s.estado==="cerrada"&&e.jsxs("div",{className:"border-l-4 border-red-500 pl-4",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Usuario Cierre"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:s.usuario_cierre?.name||"N/A"}),e.jsx("p",{className:"text-sm text-gray-500",children:s.hora_cierre?c(s.hora_cierre):"N/A"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[e.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Monto Apertura"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:t(s.monto_apertura)})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Ingresos"}),e.jsx("p",{className:"text-2xl font-bold text-green-600 mt-1",children:t(h)})]}),e.jsx("div",{className:"p-3 bg-green-100 rounded-full",children:e.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 11l5-5m0 0l5 5m-5-5v12"})})})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Egresos"}),e.jsx("p",{className:"text-2xl font-bold text-red-600 mt-1",children:t(p)})]}),e.jsx("div",{className:"p-3 bg-red-100 rounded-full",children:e.jsx("svg",{className:"w-6 h-6 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 13l-5 5m0 0l-5-5m5 5V6"})})})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Monto Esperado"}),e.jsx("p",{className:"text-2xl font-bold text-primary-600 mt-1",children:t(i)})]}),e.jsx("div",{className:"p-3 bg-primary-100 rounded-full",children:e.jsx("svg",{className:"w-6 h-6 text-primary-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})})})]})})]}),s.estado==="cerrada"&&e.jsxs("div",{className:"bg-white shadow-sm rounded-lg p-6 mb-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Información de Cierre"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Monto de Cierre"}),e.jsx("p",{className:"text-xl font-bold text-gray-900 mt-1",children:t(s.monto_cierre)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Monto Esperado"}),e.jsx("p",{className:"text-xl font-bold text-gray-900 mt-1",children:t(s.monto_esperado)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Diferencia"}),e.jsx("p",{className:`text-xl font-bold mt-1 ${parseFloat(s.diferencia)===0?"text-green-600":parseFloat(s.diferencia)>0?"text-blue-600":"text-red-600"}`,children:t(s.diferencia)})]})]})]}),e.jsxs("div",{className:"bg-white shadow-sm rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Movimientos"}),s.estado==="abierta"&&e.jsxs(m,{href:route("movimientos-caja.create"),className:"inline-flex items-center gap-2 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition font-semibold text-sm",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Nuevo Movimiento"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Fecha/Hora"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Tipo"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Categoría"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Concepto"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Monto"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Responsable"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.movimientos&&s.movimientos.length>0?s.movimientos.map(r=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:c(r.fecha_hora)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-semibold ${r.tipo==="ingreso"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:r.tipo})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:r.categoria.nombre}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:r.concepto}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:`font-bold ${r.tipo==="ingreso"?"text-green-600":"text-red-600"}`,children:[r.tipo==="ingreso"?"+":"-"," ",t(r.monto)]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:r.responsable.name})]},r.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-8 text-center text-gray-500",children:"No hay movimientos registrados"})})})]})})]}),s.observaciones&&e.jsxs("div",{className:"mt-6 bg-gray-50 border border-gray-200 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Observaciones"}),e.jsx("p",{className:"text-sm text-gray-600 whitespace-pre-wrap",children:s.observaciones})]})]})}),g&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50 flex items-center justify-center",children:e.jsx("div",{className:"relative bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"p-3 bg-red-100 rounded-full mr-4",children:e.jsx("svg",{className:"w-6 h-6 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Cerrar Caja"})]}),e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Monto Esperado:"})," ",t(i)]})}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"monto_cierre",className:"block text-sm font-medium text-gray-700 mb-2",children:"Monto de Cierre (Efectivo Real) *"}),e.jsx("input",{type:"number",id:"monto_cierre",value:l.monto_cierre,onChange:r=>x("monto_cierre",r.target.value),step:"0.01",min:"0",className:`block w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent ${o.monto_cierre?"border-red-500":"border-gray-300"}`,placeholder:"0.00",required:!0,autoFocus:!0}),o.monto_cierre&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:o.monto_cierre})]}),l.monto_cierre&&e.jsx("div",{className:`p-4 rounded-lg ${a===0?"bg-green-50 border border-green-200":a>0?"bg-blue-50 border border-blue-200":"bg-red-50 border border-red-200"}`,children:e.jsxs("p",{className:`text-sm font-semibold ${a===0?"text-green-800":a>0?"text-blue-800":"text-red-800"}`,children:["Diferencia: ",t(a),a===0&&" ✓ (Cuadra perfecto)",a>0&&" (Sobrante)",a<0&&" (Faltante)"]})}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"observaciones_cierre",className:"block text-sm font-medium text-gray-700 mb-2",children:"Observaciones del Cierre"}),e.jsx("textarea",{id:"observaciones_cierre",value:l.observaciones,onChange:r=>x("observaciones",r.target.value),rows:"3",className:"block w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"Notas adicionales sobre el cierre..."})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:()=>d(!1),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition font-semibold",disabled:n,children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:n,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition font-semibold disabled:opacity-50",children:n?"Cerrando...":"Cerrar Caja"})]})]})]})})})]})}export{M as default};
